include abstracts/data
//- include abstracts/variables
//- include abstracts/translations

include components/_mixins

input(name='attr_version', value='1.02', type='hidden')
.troika
  +panel({ name: 'header', semantic: 'header'})
    +block('header')
      input.editor__controller(name='attr_header_editor', type='hidden', value='0')
      .editor__wrapper
        - const headFields = data.header.fields.slice(0, 2);
        .editor__edit.header__edit
          .row
            .header__field.col-sm-1.header__field--character_avatar
              img.header__avatar(name='attr_character_avatar')
            each field in headFields
              - const colSpan = field.span ? `col-sm-${field.span}` : 'col';
              .header__field(class=`header__field--${field.name} ${colSpan}`)
                label(data-i18n=field.name)= field.label
                +field(field)

        .editor__view.header__view
          .header__header
            .header__field.header__field--character_avatar
              img.header__avatar(name='attr_character_avatar')

            each field in headFields
              .header__field(class=`header__field--${field.name}`)
                unless field.name==='character_name'
                  label(data-i18n=field.name)= field.label
                +span(field)

    +block('content')
      +editorblock('header')
        +block('edit')
          .row
            each field in data.header.fields.slice(2)
              - const colSpan = field.span ? `col-sm-${field.span}` : 'col';
              .header__field(class=`header__field--${field.name} ${colSpan}`)
                label(data-i18n=field.name)= field.label
                +field(field)
        +block('view')
          each field in data.header.fields.slice(2)
            .header__field(class=`header__field--${field.name}`)
              +span(field)

  +panel({ name: 'stats', semantic: 'aside'})
    +block('content')
      +editorblock('stats')
        +block('edit')
          .stats__wrapper
            each fieldset, key in data.stats.fieldsets
              .header__field(class=`header__field--${key}`)
                each field in fieldset
                  .stat(class=`stat__${field.name}`)
                    label(data-i18n=field.name)= field.label
                    +field(field).stat__input
        +block('view')
          each fieldsets, field in data.stats.fieldsets
            .stats__field(class=`stats__field--${field}`)
              +span({ name: field })

    //- each fieldset in data.stats.fieldsets
      .stats__stat
        each field in fieldset
          .stat(class=`stat__${field.name}`)
            label(data-i18n=field.name)= field.label
            +field(field).stat__input
  .panel.header
    .panel__wrapper
      .panel__header
        //- h2.panel__header--text Header
        //- .panel__header--toggle
          button.editor__toggle(name='act_header-editor', type='action')
            span.visually-hidden(data-i18n='close') Close
            span.pictos(aria-excluded='true') y
      .panel__content
        .editor
          input.editor__controller(name='attr_header_editor', value='0', type='hidden')
          .editor__wrapper.header__wrapper
            .editor__content
              .editor__view.header__view
                //- .header__image
                  .header__image--frame
                    img.header__avatar(name='attr_character_avatar')
                .header__name
                  button.editor__toggle(name='act_header-editor', type='action')
                    +span({ name: 'character_name' })
                    span.editor__icon.pictos(aria-excluded='true') y
                .header__background
                  +span({ name: 'background' })
                .header__special
                  +span({ name: 'special' })
              .editor__edit.header__edit
                //- button(name='act_header-editor', type='action')
                  span(data-i18n='close') Close
                each field in data.header.fields
                  .header__field(class=`header__field--${field.name}`)
                    label(data-i18n=field.name)= field.label
                    +field(field)
                button.editor__close(name='act_header-editor', type='action')
                  span.visually-hidden(data-i18n='close') Close

  //- +panel({ name: 'stats', semantic: 'aside'})
    +block('content')
      .editor
        input.editor__controller(name='attr_stats_editor', value='0', type='hidden')
        .editor__wrapper.stats__wrapper
          each fieldset in data.stats.fieldsets
            .stats__stat
              each field in fieldset
                .stat(class=`stat__${field.name}`)
                  label(data-i18n=field.name)= field.label
                  +field(field).stat__input

  nav.nav
    input(name='attr_nav', value='skillsspells', type='hidden')
    ul#primary-navigation.primary-navigation.nav
      each nav in data.navigation.radios
        li
          button.button--alt-text(name=`act_nav_${nav.value}`, type='action')
            span(data-i18n=nav.value)= nav.label
            span(data-i18n=nav.value)= nav.label

  main.troika__wrapper
    input(name='attr_nav', value='skillsspells', type='hidden')
    .page--skillsspells.advanced-skills
      h2.advanced-skills__title(data-i18n='advanced_skills_spells') Advanced Skills & Spells
    .page--attacks.attacks
      h2.attacks__title(data-i18n='attacks') Attacks
    .page--inventory.inventory
      h2.inventory__title(data-i18n='inventory') Inventory
    .page--miscellaneous.miscellaneous
      h2.miscellaneous__title(data-i18n='miscellaneous') Miscellaneous

  footer.footer
    span.visually-hidden(data-i18n='version') Version
    span(name='attr_version')

include templates/_rolltemplates

// === WORKERS ===
script(type='text/worker')
  include ../js/globals.js
  include ../js/eventhandlers.js
  include ../js/sheetworkers.js

- console.log(Date.now());
